pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
-- animation viewer
-- by rest


function _init()
	_upd=_update_anim_sel
	_drw=_draw_anim_sel

	-- mouse devkit mode
	poke(0x5f2d, 1)
	
	-- globals
	t=0 -- 0-59
	btwn_frames=10
	spr_n=1
	page=1
	anim_list={}
	held=false
	play_btn_clicked=false
	play_btn_was_clicked=false
end


function _update60()
	_upd()
end


function _draw()
	_drw()
	
	-- debug
	-- print("("..mouse_x..","..mouse_y..")",0,0,8)
end
-->8
-- update functions

function _update_anim_sel()
	mouse_x=stat(32)-1
	mouse_y=stat(33)-1
	mouse_inp=stat(34)
	
	-- pixel of sprite hovering
	adj_x=mouse_x-(mouse_x%8)
	adj_y=mouse_y-(mouse_y%8)
	
	if not play_btn_clicked
	   and play_btn_was_clicked then
		if on_play_btn() and #anim_list>0 then  
			_upd=_update_anim_view
			_drw=_draw_anim_view
			return
		end
		play_btn_was_clicked=false
	end
	
	-- on click
	if mouse_inp==1 and not held then
		
		if on_sel_window() then
			-- select sprite
			local sprite=(adj_y-40)*2+(adj_x/8)%16
			add(anim_list,sprite)
		elseif on_play_btn() then
			-- click play button
			play_btn_clicked=true
			play_btn_was_clicked=true
		elseif on_btwn_up() then
			btwn_frames+=1
		elseif on_btwn_down() then
			btwn_frames=max(1,btwn_frames-1)
		end
		
		held=true
		
		
	elseif mouse_inp==0 then
		held=false
		play_btn_clicked=false
	end
	
end

function _update_anim_view()
	t=(t+1)%btwn_frames
	if t==0 then
		spr_n%=count(anim_list)
		spr_n+=1
	end
end
-->8
--draw functions

function _draw_anim_sel()
	cls()
	map()
	
	-- sprite selection
	for i=0,63 do
		spr(i*page,(i%16)*8,(flr(i/16)+5)*8)
	end
	
	-- square around sprite
	if on_sel_window() then
		rect(adj_x-1,adj_y-1,adj_x+8,adj_y+8,7)
	end
	
	-- print sprites at top
	local i=1
	for n,s in pairs(anim_list) do
		if n>count(anim_list)-11 then
			spr(s,i*8+i*2,9)
			i+=1
			print(n,i*8+i*2-9,18,7)
		end
	end
	
	-- play button
	if play_btn_was_clicked then
		spr(201,96,100,2,2)
	else
		spr(203,96,100,2,2)
	end
	
	-- between frames
	print("between frames: "..btwn_frames,10,100,7)
	spr(253,70,107)
	spr(253,78,106,1,1,false,true)
	
	-- mouse
	spr(255,mouse_x,mouse_y)
	
end

function _draw_anim_view()
	cls()
	
	spr(anim_list[spr_n],60,60)
end
-->8
-- mouse location assertions

function on_sel_window()
	return mouse_y>=40 and
				mouse_y<72
end

function on_play_btn()
	return mouse_x>=96
		and mouse_x<112
		and mouse_y>=100
		and mouse_y<116
end

function on_btwn_up()
	return mouse_x>70
		and mouse_x<76
		and mouse_y>108
		and mouse_y<113
end

function on_btwn_down()
	return mouse_x>78
		and mouse_x<84
		and mouse_y>107
		and mouse_y<112
end
__gfx__
0000000000000000000000000000000000000000000000000000000000000000cccccccc00000000000000000000000000000000000000000000000000000000
0007770000077000000777000007770000070700000777000007000000077700cccccccc00000000000000000000000000000000000000000000000000000000
0007070000007000000007000000070000070700000700000007000000000700cccccccc00000000000000000000000000000000000000000000000000000000
0007070000007000000777000000770000077700000777000007770000000700cccccccc00000000000000000000000000000000000000000000000000000000
0007070000007000000700000000070000000700000007000007070000000700cccccccc00000000000000000000000000000000000000000000000000000000
0007770000077700000777000007770000000700000777000007770000000700cccccccc00000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000cccccccc00000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000cccccccc00000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000bbbbbbbbbbbb0000bbbbbbbbbbbb00000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000bbbbbbbbbbbb0000bbbbbbbbbbbb00055555555555555555555550
00000000000000000000000000000000000000000000000000000000000000000000000033333333333333bb33bbbbbbbbbbbbbb056666666666666666666650
00000000000000000000000000000000000000000000000000000000000000000000000033333333333333bb33bb777bbbbbbbbb056777777777777777777650
00000000000000000000000000000000000000000000000000000000000000000000000033377733333333bb33bb77777bbbbbbb056766666666666666667650
00000000000000000000000000000000000000000000000000000000000000000000000033377777333333bb33bb7777777bbbbb056765555555555555567650
00000000000000000000000000000000000000000000000000000000000000000000000033377777773333bb33bb777777777bbb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000033377777777733bb33bb7777777777bb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000033377777777773bb33bb777777777bbb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000033377777777733bb33bb7777777bbbbb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000033377777773333bb33bb77777bbbbbbb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000033377777333333bb33bb777bbbbbbbbb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000033377733333333bb33bbbbbbbbbbbbbb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000033333333333333bb33bbbbbbbbbbbbbb056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000000333333333333000033333333333300056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000000333333333333000033333333333300056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056765000000000000567650
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056765555555555555567650
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056766666666666666667650
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056777777777777777777650
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056666666666666666666650
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055555555555555555555550
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000660000017100000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006660000666600017710000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006660000666660017771000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666000666600017777100
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666000660000017711000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001171000
__map__
cdcececececececececececececececf00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dd0000000000000000000000000000df00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dd0000000000000000000000000000df00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
edeeeeeeeeeeeeeeeeeeeeeeeeeeeeef00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cececececececececececececececece00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cdcececececececececececececececf00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dd0000000000000000000000000000df00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dd0000000000000000000000000000df00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dd0000000000000000000000000000df00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
edeeeeeeeeeeeeeeeeeeeeeeeeeeeeef00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
